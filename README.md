# Telegram Welcome Bot

Простий Telegram-бот, який надсилає привітання користувачу після команди `/start`.

Текст відповіді:  
`Вітаємо! Менеджер відповість Вам у найближчий час. Звертаємо увагу, що ми працюємо у будні дні з 09 по 18.`

## Запуск

1. Потрібен Python 3.9+ (додаткові пакети не потрібні).
2. Отримайте токен у BotFather та запишіть у файл `.env` у корені:
   ```bash
   echo "TELEGRAM_BOT_TOKEN=ваш_токен" > .env
   ```
   (або виставте змінну вручну: `export TELEGRAM_BOT_TOKEN=ваш_токен`)
   Якщо хочете перевіряти номер у KeyCRM, додайте туди ж:
   ```bash
   echo "KEYCRM_TOKEN=ваш_keycrm_token" >> .env
   ```
   Щоб обмежити доступ, вкажіть дозволені chat_id (через кому):
   ```bash
   echo "ALLOWED_CHAT_IDS=12345,67890" >> .env
   ```
3. Запустіть бота:
   ```bash
   python bot.py
   ```
4. Напишіть боту в Telegram `/start` — у відповідь прийде привітальне повідомлення українською.
   Разом з ним з’явиться кнопка «Поділитися телефоном»; після натискання бот підтвердить отримання номера і повідомить, чи є він у CRM, як записаний та хто менеджер (за наявності `KEYCRM_TOKEN`). Якщо контакт знайдений, бот додасть у примітку покупця рядок із текстом своєї відповіді.
   Можна просто надіслати номер текстом — бот приведе його до формату `+380XXXXXXXXX`, перевірить у CRM і відповість так само.

> Якщо бот був доданий у CRM як вебхук і ви отримуєте 409 Conflict, скрипт автоматично викличе `deleteWebhook` при старті, щоб увімкнути long polling.

Зупинити роботу можна `Ctrl+C`.

### Якщо бачите помилку SSL (self-signed certificate)
- У корпоративних мережах трафік можуть перехоплювати власним сертифікатом. Укажіть шлях до довіреного CA:
  ```bash
  export TELEGRAM_CA_BUNDLE=/шлях/до/кореневого_сертифіката.pem
  ```
- Або тимчасово вимкніть перевірку TLS (менш безпечно, лише якщо довіряєте мережі):
  ```bash
  export TELEGRAM_SKIP_TLS_VERIFY=1
  ```
# tg-crm
